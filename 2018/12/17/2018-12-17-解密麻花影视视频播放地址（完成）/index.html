<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>2018-12-17-解密麻花影视视频播放地址（完成） | 凉凉小线仔</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="经过上篇文章的处理重打包，现在app已经能够抓包了，我们抓一下视频播放地址看看。(这是当前热播电视剧《将夜》第一集的播放地址) 解密和模拟请求的核心代码在github上面 目的：解密下面抓包的http 响应体。 123456789101112131415161718192021222324252627282930313233GET /api/app/video/ver2/user/clickPla">
<meta name="keywords" content="Android,逆向,麻花影视">
<meta property="og:type" content="article">
<meta property="og:title" content="2018-12-17-解密麻花影视视频播放地址（完成）">
<meta property="og:url" content="http://qiang.github.io/2018/12/17/2018-12-17-解密麻花影视视频播放地址（完成）/index.html">
<meta property="og:site_name" content="凉凉小线仔">
<meta property="og:description" content="经过上篇文章的处理重打包，现在app已经能够抓包了，我们抓一下视频播放地址看看。(这是当前热播电视剧《将夜》第一集的播放地址) 解密和模拟请求的核心代码在github上面 目的：解密下面抓包的http 响应体。 123456789101112131415161718192021222324252627282930313233GET /api/app/video/ver2/user/clickPla">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://qiang.github.io/images/2018/12/2018-12-17-1.png">
<meta property="og:updated_time" content="2019-01-02T09:38:57.242Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2018-12-17-解密麻花影视视频播放地址（完成）">
<meta name="twitter:description" content="经过上篇文章的处理重打包，现在app已经能够抓包了，我们抓一下视频播放地址看看。(这是当前热播电视剧《将夜》第一集的播放地址) 解密和模拟请求的核心代码在github上面 目的：解密下面抓包的http 响应体。 123456789101112131415161718192021222324252627282930313233GET /api/app/video/ver2/user/clickPla">
<meta name="twitter:image" content="http://qiang.github.io/images/2018/12/2018-12-17-1.png">
  
    <link rel="alternate" href="/atom.xml" title="凉凉小线仔" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">凉凉小线仔</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">基于Android 高于Android</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://qiang.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2018-12-17-解密麻花影视视频播放地址（完成）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/17/2018-12-17-解密麻花影视视频播放地址（完成）/" class="article-date">
  <time datetime="2018-12-17T06:46:31.000Z" itemprop="datePublished">2018-12-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>►<a class="article-category-link" href="/categories/Android/逆向/">逆向</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2018-12-17-解密麻花影视视频播放地址（完成）
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>经过上篇文章的处理重打包，现在app已经能够抓包了，我们抓一下视频播放地址看看。(这是当前热播电视剧《将夜》第一集的播放地址)</p>
<p><strong>解密和模拟请求的核心代码在<a href="https://github.com/AndSmali/mahuayingshi-java" target="_blank" rel="noopener">github上面</a></strong></p>
<p>目的：解密下面抓包的http 响应体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">GET /api/app/video/ver2/user/clickPlayVideo_2_2/2/7?videoId=71771&amp;playType=0&amp;time=1545026021155 HTTP/1.1</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: application/json</span><br><span class="line">accessToken: d9a8e5a2bea0d56c0e39baf16f7e43ad35707c79cb28f4d1016f280b6f5deb47</span><br><span class="line">X-Client-NonceStr: A3UOht4UC0</span><br><span class="line">X-Client-IP: 127.0.0.1</span><br><span class="line">X-Client-TimeStamp: 1545026021155</span><br><span class="line">X-Client-Version: 2.3.0</span><br><span class="line">X-Client-Sign: 827a5719ee3efb1e2386d06e41ca64add61fa7dce11452155c14f7c4449a7c73</span><br><span class="line">X-Client-Token: </span><br><span class="line">X-Auth-Token: mb_token:18252297:3c4eaf5d92196fd39968081553be65e8</span><br><span class="line">Host: api.hbzjmf.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br><span class="line">User-Agent: okhttp/3.11.0</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: Tengine</span><br><span class="line">Content-Type: application/json;charset=UTF-8</span><br><span class="line">Content-Length: 736</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Date: Mon, 17 Dec 2018 05:53:41 GMT</span><br><span class="line">X-Server-TimeStamp: 1545026021</span><br><span class="line">accessToken: d9a8e5a2bea0d56c0e39baf16f7e43ad35707c79cb28f4d1016f280b6f5deb47</span><br><span class="line">Ali-Swift-Global-Savetime: 1545026021</span><br><span class="line">Via: cache31.l2cm9[54,200-0,M], cache39.l2cm9[55,0], kunlun5.cn36[64,200-0,M], kunlun2.cn36[65,0]</span><br><span class="line">X-Cache: MISS TCP_MISS dirn:-2:-2</span><br><span class="line">X-Swift-SaveTime: Mon, 17 Dec 2018 05:53:41 GMT</span><br><span class="line">X-Swift-CacheTime: 0</span><br><span class="line">Timing-Allow-Origin: *</span><br><span class="line">EagleId: 3c1ce20215450260211213683e</span><br><span class="line"></span><br><span class="line">6cab6feb4e159bdbcb652ffd544a32db308bb2bd2b00f17c9a3d523c69159a0ed7589f602c30130ad2f0213226281767123cac47ca86c8f24511cec75a89b19227ecbae6b5f4ce564561098f2b12d2d48e7f8e38cf6c0641beef2b4c2afa9ac329da660ce6166357dc72baa05f7a27073510401fa4827515b2af58d33e5a2316785322bd141117368b522265cf03bf7eb4e406701df588f76fee55cfe9e2101eab3c29933d64015b25b8d759658c6473c3fd53c39ea15e47cd913ffd2cdc7251c43b9735bf486ef140457046024cd8d7b608e3448a58704657247f50e61fb7259f7302aea6824351455093d614d162aa06cb6bcf4c00ae8ca9d932d09fc8d444a5b121b0b61570a3b544db61eb334affad3abc4060f0720f2ca893217dde2a4957d3066bac004d6ad88bb16077de6771c56332bc2df5046cef7c67292c17011df11da6b22aa27fc237c11aaa6b4f099e2f457e92ae0322c1b548e9a61e628ebb70a747e4c08dda8e77353654a7f80853</span><br></pre></td></tr></table></figure>
<p>哈哈，加密了，别慌客户端肯定有解密代码。</p>
<p>根据url直接找到 Retrofit的定义的地方：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//com.mh.movie.core.mvp.model.a.a</span><br><span class="line">    @GET(&quot;/api/app/video/ver2/user/clickPlayVideo_2_2/&quot;)</span><br><span class="line">    @Headers(&#123;&quot;Content-Type: application/json&quot;&#125;)</span><br><span class="line">    Observable&lt;String&gt; a(@Query(&quot;videoId&quot;) int i, @Query(&quot;playType&quot;) int i2);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>从这个方法的返回值可以发现，Retrofit接到的解析后的http 返回值为String类型。用的是 ： ScalarsConverterFactory，这点很重要</p>
</blockquote>
<p>根据Retrofit的基本用法大概分析一下：</p>
<p>在jadx里面，通过在上面方法上右键–&gt;FindUsage 找到了唯一的应用的地方<code>com.mh.movie.core.mvp.model.b.d</code> 这个类是根据<code>PlayerDao</code> 反编译出来的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public Observable&lt;String&gt; a(int i, int i2) &#123;</span><br><span class="line">    return ((a) this.a.obtainRetrofitService(a.class)).a(i, i2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依然 方法上右键–&gt;FindUsage 找到 <code>com.mh.movie.core.mvp.model.player.PlayerModel</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public Observable&lt;String&gt; a(int i, int i2) &#123;</span><br><span class="line">     return this.d.a(i, i2);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>这时候我们可以得到一个调用链：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">com.mh.movie.core.mvp.model.player.PlayerModel.a(int, int)</span><br><span class="line">  |--com.mh.movie.core.mvp.model.b.d.a(int, int) //PlayerDao.a(int,int)</span><br><span class="line">    |--com.mh.movie.core.mvp.model.a.a.a(@Query(&quot;videoId&quot;) int i, @Query(&quot;playType&quot;) int i2)//Retrofit 中自定义Service</span><br></pre></td></tr></table></figure>
<p>先猜测一下吧、既然用了mvp那么网络请求的控制应该在 Presenter里面，那么 PlayerModel 肯定是被 PlayerPresenter 调用，根据方法签名，也就是两个int参数，来查找：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//可疑方法，PlayerPresenter</span><br><span class="line">    public void a(int i, String str, Integer num) &#123;</span><br><span class="line">        ((b) this.d).a(&quot;&quot;, null, 0);</span><br><span class="line">        final int i2 = i;</span><br><span class="line">        final Integer num2 = num;</span><br><span class="line">        final String str2 = str;</span><br><span class="line">        //    protected V d;</span><br><span class="line">        //   Application g;</span><br><span class="line">        ((a) this.c).a(this.G, i).compose(a(this.g, this.d, false))</span><br><span class="line">        .subscribe(new com.mh.movie.core.mvp.model.a.b&lt;VideoAddressResponse&gt;(this.f, new com.google.gson.b.a&lt;BaseResponse&lt;VideoAddressResponse&gt;&gt;() &#123;&#125;.getType()) &#123;</span><br><span class="line">            public void a(VideoAddressResponse videoAddressResponse) &#123;</span><br><span class="line">                PlayerPresenter.this.B = videoAddressResponse;</span><br><span class="line">                int i = 0;</span><br><span class="line">                if (i2 &gt; 0) &#123;</span><br><span class="line">                    PlayerPresenter.this.n = 0;</span><br><span class="line">                    PlayerPresenter.this.j().setPlayType(0);</span><br><span class="line">                    if (i2 == 2) &#123;</span><br><span class="line">                        TableCommodity c = PlayerPresenter.this.c(10);</span><br><span class="line">                        c.hasFlag = 2;</span><br><span class="line">                        c.save();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else if (PlayerPresenter.this.n == -1) &#123;</span><br><span class="line">                    while (i &lt; 4) &#123;</span><br><span class="line">                        if (videoAddressResponse.getM3u8Format().getM3u8Format(i) != null) &#123;</span><br><span class="line">                            PlayerPresenter.this.n = i;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;</span><br><span class="line">                        i++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure>
<p>这只是根据方法签名和rxjava的基本逻辑进行猜测的。我们来动态调试一下。</p>
<p>断点打在上面的方法上。<code>((a) this.c).a(this.G, i)</code>在这一行上，我们，进入这个a里面看看是不是调用了我们一开始分析的。果然是这个方法，看下调用堆栈：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a:696, PlayerPresenter (com.mh.movie.core.mvp.presenter.player)</span><br><span class="line">a:323, PlayerPresenter (com.mh.movie.core.mvp.presenter.player)</span><br><span class="line">a:539, PlayerPresenter (com.mh.movie.core.mvp.presenter.player)</span><br><span class="line">a:670, PlayerPresenter$1 (com.mh.movie.core.mvp.presenter.player)</span><br><span class="line">a:617, PlayerPresenter$1 (com.mh.movie.core.mvp.presenter.player)</span><br><span class="line">a:69, b (com.mh.movie.core.mvp.model.a)</span><br><span class="line">onNext:30, b (com.mh.movie.core.mvp.model.a)</span><br><span class="line">//......</span><br></pre></td></tr></table></figure>
<p>这个时候获取到的是真实的播放地址，而我们抓包抓到的返回值明显是加过密的，那么解密的过程很有可能在OkHttp的 Interceptor 中，还有可能在 在 Retrofit的 ConverterFactory 中。我们先来分析在 Intercepter中的情况。。。</p>
<blockquote>
<p>TMD,分析这个项目难就难在他用了依赖注入框架Dagger。我特么不会用这个东西，好多重要的对象的构建我找不到对应的地方，比如OkhttpClient和Retrofit的创建，这里面肯定有好多全局设置，我在这个项目里面找不到他们如何创建的很多只能靠猜测，我这就滚去学习去。</p>
</blockquote>
<p>看这个类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// com.jess.arms.b.b.f   注意这个方法的最后一个参数</span><br><span class="line">    @Singleton</span><br><span class="line">    static OkHttpClient a(Application application, @Nullable b bVar, Builder builder, Interceptor interceptor, @Nullable List&lt;Interceptor&gt; list, @Nullable final com.jess.arms.http.b bVar2) &#123;</span><br><span class="line">        a aVar = new a();</span><br><span class="line">        builder.proxy(Proxy.NO_PROXY).connectTimeout(10, TimeUnit.SECONDS).readTimeout(10, TimeUnit.SECONDS).sslSocketFactory(a(aVar), aVar).hostnameVerifier(new e()).addNetworkInterceptor(interceptor);</span><br><span class="line">        if (bVar2 != null) &#123;</span><br><span class="line">            builder.addInterceptor(new Interceptor() &#123;</span><br><span class="line">                public Response intercept(Chain chain) throws IOException &#123;</span><br><span class="line">                //这里会有处理，我们找到这个bVar2 的实现类,然后断点调试一下，发现返回值依然是加密的</span><br><span class="line">                    return chain.proceed(bVar2.a(chain, chain.request()));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (list != null) &#123;</span><br><span class="line">            for (Interceptor addInterceptor : list) &#123;</span><br><span class="line">                builder.addInterceptor(addInterceptor);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (bVar != null) &#123;</span><br><span class="line">            bVar.a(application, builder);</span><br><span class="line">        &#125;</span><br><span class="line">        return builder.build();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>找到 bVar2的实现类 <code>.class public Lcom/mh/movie/core/app/i;</code>，那么剩下的还有就是参数 list 和 参数 interceptor 了。。。我现在找不到这两个东西是怎么注入进来的。</p>
<p>再回过头来想一想，我门虽然不知道这个东西怎么注入到Retrofit中的，但是我们可以动态调试Retrofit，观察一下他的OKhttpClient里面的额 Interceptor 。看 PlayerPresenter 里面的调用，打上断点观察 Retrofit类。对应这个方法 <code>.method public a(ILjava/lang/String;Ljava/lang/Integer;)V</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//调用链</span><br><span class="line">((a) this.c).a(this.G, i)   //com.mh.movie.core.mvp.a.b.a.a(this.G, i)这个是 PlayerModel 类的接口</span><br><span class="line">    |--Lcom/mh/movie/core/mvp/model/player/PlayerModel.a(this.G, i)</span><br><span class="line">       |--Lcom/mh/movie/core/mvp/model/b/d;-&gt;a(II)（PlayerDao.java）</span><br><span class="line">         |-- ((a) this.a.obtainRetrofitService(a.class)).a(i, i2);//fuck ,fuck ,里面的 构建又是用 Dagger搞的。fuck</span><br><span class="line">         //既然this.a能够构建Retrofit的Service，那么this.a 里面很有可能包含Retrofit这个类</span><br></pre></td></tr></table></figure>
<p>分析这个this.a 这是个IRepositoryManager ，根据程序员命名规范，那么这个玩意的实现类很有可能叫做 <code>RepositoryManager</code> 其次叫做 <code>RepositoryManagerImpl</code> jdax全局类搜索。得到 <code>com.jess.arms.integration.RepositoryManager</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//this.a 就是这个类的对象我们要的 Retrofit 对象是this.a.mRetrofit.get()</span><br><span class="line">@Singleton</span><br><span class="line">public class RepositoryManager implements IRepositoryManager &#123;</span><br><span class="line">    @Inject</span><br><span class="line">    Application mApplication;</span><br><span class="line">    private Cache&lt;String, Object&gt; mCacheServiceCache;</span><br><span class="line">    @Inject</span><br><span class="line">    Factory mCachefactory;</span><br><span class="line">    @Inject</span><br><span class="line">    a&lt;Retrofit&gt; mRetrofit;</span><br><span class="line">    private Cache&lt;String, Object&gt; mRetrofitServiceCache;</span><br><span class="line">    @Inject</span><br><span class="line">    a&lt;j&gt; mRxCache;</span><br><span class="line"></span><br><span class="line">    public synchronized &lt;T&gt; T obtainRetrofitService(Class&lt;T&gt; cls) &#123;</span><br><span class="line">        T t;</span><br><span class="line">        if (this.mRetrofitServiceCache == null) &#123;</span><br><span class="line">            this.mRetrofitServiceCache = this.mCachefactory.build(CacheType.RETROFIT_SERVICE_CACHE);</span><br><span class="line">        &#125;</span><br><span class="line">        g.a(this.mRetrofitServiceCache, (Object) &quot;Cannot return null from a Cache.Factory#build(int) method&quot;);</span><br><span class="line">        t = this.mRetrofitServiceCache.get(cls.getCanonicalName());</span><br><span class="line">        if (t == null) &#123;</span><br><span class="line">            t = ((Retrofit) this.mRetrofit.get()).create(cls);</span><br><span class="line">            this.mRetrofitServiceCache.put(cls.getCanonicalName(), t);</span><br><span class="line">        &#125;</span><br><span class="line">        return t;</span><br><span class="line">    &#125;</span><br><span class="line">    //.......</span><br></pre></td></tr></table></figure>
<p>上面的 this.a 就是类<code>com.jess.arms.integration.RepositoryManager</code>的对象我们要的 Retrofit 对象是this.a.mRetrofit.get()的到的值。</p>
<p>动态调试，断点打在 <code>.class public Lcom/mh/movie/core/mvp/model/b/d;</code>的 <code>.method public a(II)Lio/reactivex/Observable;</code>方法上，然后分析内存里面的值。</p>
<p><img src="/images/2018/12/2018-12-17-1.png" alt=""></p>
<p>Interceptor 分两个：interceptors 和 networkInterceptors 分别对应：<br>addInterceptor 和 addNetworkInterceptor</p>
<p>interceptors 有两个：com.jess.arms.b.b.f$1里面的匿名对象和 RetrofitUrlManager$1 并没有解密。 </p>
<p>我们去看 networkInterceptors 。这个数组也有两个：</p>
<p><code>class com.jess.arms.http.log.RequestInterceptor</code> 和 <code>class me.jessyan.progressmanager.b$1</code></p>
<p>调试发现这个  RequestInterceptor  里面并不会改变这个加密字符串。</p>
<p>从动态调试的角度来说，解密操作不是OkhttpClient的 Interceptor引起的。但是我依然不太确定。接下来，去了解Retrofit的源码，去找一下，Okhttp是如何把数据递交到Retrofit的。然后hook这个地方的代码，用来确定解密操作倒是是不是Okhttp操作的。。。。。</p>
<p>而 只有从内存状态来看只有四个</p>
<ol>
<li>class retrofit2.BuiltInConverters</li>
<li>class retrofit2.converter.scalars.ScalarsConverterFactory</li>
<li>class com.jess.arms.b.b.ab   </li>
<li>class retrofit2.converter.gson.GsonConverterFactory</li>
</ol>
<p>hook 一下这几个 Converter 具体的执行，观察这个项目调用了哪个，并且打印Converter 转换之后的返回值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">private static void hookConverter(final XC_LoadPackage.LoadPackageParam loadPackageParam) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        Class GsonResponseBodyConverter = loadPackageParam.classLoader.loadClass(&quot;retrofit2.converter.gson.GsonResponseBodyConverter&quot;);</span><br><span class="line">        Class ResponseBody = loadPackageParam.classLoader.loadClass(&quot;okhttp3.ResponseBody&quot;);</span><br><span class="line"></span><br><span class="line">        XposedHelpers.findAndHookMethod(GsonResponseBodyConverter,</span><br><span class="line">                &quot;convert&quot;,</span><br><span class="line">                ResponseBody,</span><br><span class="line">                new XC_MethodHook() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                        Log.d(&quot;Q_M&quot;, &quot;GsonResponseBodyConverter--convert--&gt;&quot; + param.args[0]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">        Class StringResponseBodyConverter = loadPackageParam.classLoader.loadClass(&quot;retrofit2.converter.scalars.ScalarResponseBodyConverters$StringResponseBodyConverter&quot;);</span><br><span class="line">        Log.d(&quot;Q_M&quot;, &quot;找到类:&quot; + StringResponseBodyConverter);</span><br><span class="line">        XposedHelpers.findAndHookMethod(StringResponseBodyConverter,</span><br><span class="line">                &quot;convert&quot;,</span><br><span class="line">                ResponseBody,</span><br><span class="line">                new XC_MethodHook() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                        super.afterHookedMethod(param);</span><br><span class="line">                        Log.d(&quot;Q_M&quot;, &quot;StringResponseBodyConverter--convert--&gt;&quot; + param.getResult().toString());</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行发现GsonResponseBodyConverter 里面的方法并没有被hook到，也就是没有执行GsonResponseBodyConverter的转换过程。而是调用了<code>ScalarResponseBodyConverters$StringResponseBodyConverter</code> 所以 Retrofit 接收到的转换后的结果是个字符串，并且这个字符串依然是加密状态的。也就是说字符串的解析（解析成相应对象），或者字符串解密都是在Retrofit获取到结果之后操作的，看Rxjava如何处理这个str的，这个处理过程肯定在Rxjava的subscribe的 Observer 里面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//PlayerPresenter 类中的可疑方法</span><br><span class="line">public void a(int i, String str, Integer num) &#123;</span><br><span class="line">    ((b) this.d).a(&quot;&quot;, null, 0);</span><br><span class="line">    final int i2 = i;</span><br><span class="line">    final Integer num2 = num;</span><br><span class="line">    final String str2 = str;</span><br><span class="line">    //    protected V d;</span><br><span class="line">    //   Application g;</span><br><span class="line">    ((a) this.c).a(this.G, i).compose(a(this.g, this.d, false))</span><br><span class="line">    .subscribe(new com.mh.movie.core.mvp.model.a.b&lt;VideoAddressResponse&gt;(this.f, new com.google.gson.b.a&lt;BaseResponse&lt;VideoAddressResponse&gt;&gt;()&#123;&#125;.getType()) &#123;</span><br><span class="line">        public void a(VideoAddressResponse videoAddressResponse) &#123;</span><br><span class="line">            PlayerPresenter.this.B = videoAddressResponse;</span><br><span class="line">            int i = 0;</span><br><span class="line">            if (i2 &gt; 0) &#123;</span><br><span class="line">                PlayerPresenter.this.n = 0;</span><br><span class="line">                PlayerPresenter.this.j().setPlayType(0);</span><br><span class="line">                if (i2 == 2) &#123;</span><br><span class="line">                    TableCommodity c = PlayerPresenter.this.c(10);</span><br><span class="line">                    c.hasFlag = 2;</span><br><span class="line">                    c.save();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else if (PlayerPresenter.this.n == -1) &#123;</span><br><span class="line">                while (i &lt; 4) &#123;</span><br><span class="line">                    if (videoAddressResponse.getM3u8Format().getM3u8Format(i) != null) &#123;</span><br><span class="line">                        PlayerPresenter.this.n = i;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>看这个类 <code>new com.mh.movie.core.mvp.model.a.b&lt;VideoAddressResponse&gt;(this.f, new com.google.gson.b.a&lt;BaseResponse&lt;VideoAddressResponse&gt;&gt;(){}.getType()</code></p>
<p>这个 <code>this.f</code> 是 <code>RxErrorHandler f;</code> 也就是错误处理，不用管它。<br>第二个参数是json要解析成的对象的类型。所以猜测str解析成对象的过程很可能在这里面执行。去看这个类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//public abstract class b&lt;E&gt; implements Observer&lt;String&gt; </span><br><span class="line">//这是这个类里面的核心方法，看到变量的命名了吗，这就是解密的地方</span><br><span class="line">    /* renamed from: a */</span><br><span class="line">    public void onNext(String str) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            String decryptHex = AesUtil.decryptHex(str, AesUtil.getKey(false));</span><br><span class="line">            if (decryptHex != null) &#123;</span><br><span class="line">                str = decryptHex;</span><br><span class="line">            &#125;</span><br><span class="line">            com.mh.movie.core.mvp.ui.b.x = null;</span><br><span class="line">            BaseResponse baseResponse = (BaseResponse) new f().a().c().a(str, this.c);</span><br><span class="line">            if (baseResponse.isSuccess()) &#123;</span><br><span class="line">                a(baseResponse.getData());</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            b(baseResponse.getCode());</span><br><span class="line">            StringBuilder stringBuilder = new StringBuilder();</span><br><span class="line">            stringBuilder.append(baseResponse.getDescription());</span><br><span class="line">            stringBuilder.append(baseResponse.getCode());</span><br><span class="line">            c(stringBuilder.toString());</span><br><span class="line">        &#125; catch (Throwable th) &#123;</span><br><span class="line">            a.a(th);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>可以看到对字符串的加解密完全是java代码，而且还是个独立的工具类，那就很舒服了。我们抽取出来解密一下，我们文章最开始用Charles获取的加密的http返回值。在构造这个 AesUtil 这个工具类的时候，其他参数都很简单，但是构建aes key的时候 有个参数 <code>String packageId = RHelp.getPackageId();</code> 这个东西的看下如何构建的：</p>
<p>//在jadx中不断使用 find usage 就能找到，在 MHApplication 里面初始化的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//看下这个方法，其实很简单，就是从 Assets 文件夹下面读取一个文件 pack_info</span><br><span class="line">//但是呢这个文件内容是加密后的一个字符串，我们用默认密钥，解密这个字符串，可以得到一个json</span><br><span class="line">//AesUtil.getKey(true) 这个传入参数true表示使用默认密钥</span><br><span class="line">    private void g() throws Exception &#123;</span><br><span class="line">        InputStream open = getAssets().open(&quot;pack_info&quot;);</span><br><span class="line">        byte[] bArr = new byte[open.available()];</span><br><span class="line">        open.read(bArr);</span><br><span class="line">        open.close();</span><br><span class="line">        String str = new String(bArr, &quot;utf8&quot;);</span><br><span class="line">        String decryptHex = AesUtil.decryptHex(str, AesUtil.getKey(true));</span><br><span class="line">        if (decryptHex != null) &#123;</span><br><span class="line">            str = decryptHex;</span><br><span class="line">        &#125;</span><br><span class="line">        //这个e是混淆后的Gson类</span><br><span class="line">        RHelp.initInfo((PackInfo) new com.google.gson.e().a(str, PackInfo.class));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>我们现在解密下在文章最开始得到的加密后的http返回结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String str = &quot;6cab6feb4e159bdbcb652ffd544a32db308bb2bd2b00f17c9a3d523c69159a0ed7589f602c30130ad2f0213226281767123cac47ca86c8f24511cec75a89b19227ecbae6b5f4ce564561098f2b12d2d48e7f8e38cf6c0641beef2b4c2afa9ac329da660ce6166357dc72baa05f7a27073510401fa4827515b2af58d33e5a2316785322bd141117368b522265cf03bf7eb4e406701df588f76fee55cfe9e2101eab3c29933d64015b25b8d759658c6473c3fd53c39ea15e47cd913ffd2cdc7251c43b9735bf486ef140457046024cd8d7b608e3448a58704657247f50e61fb7259f7302aea6824351455093d614d162aa06cb6bcf4c00ae8ca9d932d09fc8d444a5b121b0b61570a3b544db61eb334affad3abc4060f0720f2ca893217dde2a4957d3066bac004d6ad88bb16077de6771c56332bc2df5046cef7c67292c17011df11da6b22aa27fc237c11aaa6b4f099e2f457e92ae0322c1b548e9a61e628ebb70a747e4c08dda8e77353654a7f80853&quot;;</span><br><span class="line">String decryptHex = AesUtil.decryptHex(str, AesUtil.getKey(false));</span><br><span class="line"></span><br><span class="line">System.out.println(&quot;decrypt:--&gt;&quot; + decryptHex);</span><br></pre></td></tr></table></figure>
<p>输出结果如下（为了方便阅读我把结果格式化了）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"success"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"code"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"description"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"imgAddr"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"videoAddr"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;</span><br><span class="line">        <span class="attr">"m3u8PlayUrl"</span>: <span class="string">"http://v.gmitking.com/mahua/2332/rpup19lfbuf2skc/"</span>,</span><br><span class="line">        <span class="attr">"m3u8Format"</span>: &#123;</span><br><span class="line">            <span class="attr">"360P"</span>: <span class="string">"rpup19lfbuf2skc_1_eb8b25960fd046ddbc925a8673cb0c4e.m3u8"</span>,</span><br><span class="line">            <span class="attr">"480P"</span>: <span class="string">"rpup19lfbuf2skc_1_f8a6196027d24e7aac871627ab86f69a.m3u8"</span>,</span><br><span class="line">            <span class="attr">"free"</span>: <span class="string">"rpup19lfbuf2skc_1_97fc2b818def488695ea74432329b055.m3u8"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好了视频480p的播放地址就是：<a href="http://v.gmitking.com/mahua/2332/rpup19lfbuf2skc/rpup19lfbuf2skc_1_f8a6196027d24e7aac871627ab86f69a.m3u8" target="_blank" rel="noopener">http://v.gmitking.com/mahua/2332/rpup19lfbuf2skc/rpup19lfbuf2skc_1_f8a6196027d24e7aac871627ab86f69a.m3u8</a></p>
<p>找个能播放 m3u8 视频格式的播放器，把这个链接丢进去就能播放了。我用的<a href="https://github.com/lhc70000/iina" target="_blank" rel="noopener">IINA</a></p>
<blockquote>
<p>总结一下，其实一开始的分析走偏走远了，主要没有仔细分析，先入为主的思想影响太深，在看到 Retrofit的Service里面定义所有的返回值类型为String的时候就该想到 Retrofit 用的不是 GsonConverterFactory 做解析的。一般来说我们会在在Interceptor 或者在自定义Converter里面加解密。而这个人的开发显然选择了一种比较简单粗暴的方式，就是在Retrofit的Service里面定义所有的返回值类型为String，然后在 RxJava 的 Observer 里面统一处理字符串，要么解密要么解析成对象。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://qiang.github.io/2018/12/17/2018-12-17-解密麻花影视视频播放地址（完成）/" data-id="cjrh5zfzp00fst124lr8j95co" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/逆向/">逆向</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/麻花影视/">麻花影视</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/12/18/2018-12-18-麻花影视模拟发送请求（完成）/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2018-12-18-麻花影视模拟发送请求（完成）
        
      </div>
    </a>
  
  
    <a href="/2018/12/16/2018-12-16-绕过麻花影视抓包检测（完成）/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2018-12-16-绕过麻花影视抓包检测（完成）</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/AndroidStudio/">AndroidStudio</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Chrome插件/">Chrome插件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/IPC/">IPC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/MPAndroidChart/">MPAndroidChart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Notification/">Notification</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Smali/">Smali</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/ValueAnimator/">ValueAnimator</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/adb/">adb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/ndk/">ndk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/ndk/jni/">jni</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/动画/">动画</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/文件存储/">文件存储</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/编译/">编译</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/逆向/">逆向</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/AndroidStudio/">AndroidStudio</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AndroidStudio/Android/">Android</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/">Blog</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/WorPress/">WorPress</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/Web/">Web</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/搜索/">搜索</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hive/">Hive</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Android/面试/">面试</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/加密/">加密</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/算法/">算法</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/压缩/">压缩</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/压缩/Zip/">Zip</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/命令行/">命令行</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/命令行/">命令行</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/SQL/">SQL</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/">Nodejs</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/npm/">npm</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PhotoShop/">PhotoShop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PostGreSQL/">PostGreSQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Django/">Django</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/工具/">工具</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sublime/">Sublime</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Sublime/工具/">工具</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/blog/Jekyll/">Jekyll</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/postgres/">postgres</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人想法/">个人想法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/加密/">加密</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/加密/协议/">协议</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/周易/">周易</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/编码/">编码</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidStudio/">AndroidStudio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binder/">Binder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blog/">Blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome插件/">Chrome插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gradle/">Gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gson/">Gson</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IPC/">IPC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jekyll/">Jekyll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MPAndroidChart/">MPAndroidChart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notification/">Notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PS笔记/">PS笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PhotoShop/">PhotoShop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostGreSQL/">PostGreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Proguard/">Proguard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Smali/">Smali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime/">Sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ValueAnimator/">ValueAnimator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ViewPager/">ViewPager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WorPress/">WorPress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zip/">Zip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/adb/">adb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jni/">jni</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ndk/">ndk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgres/">postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/个人想法/">个人想法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/其他/">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/加密/">加密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动画/">动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/协议/">协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/压缩/">压缩</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/周易/">周易</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/命令行/">命令行</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/大数据/">大数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/快捷键/">快捷键</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/打包/">打包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件存储/">文件存储</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/泛型/">泛型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/源码/">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/站内搜索/">站内搜索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编码/">编码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编译/">编译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/解密/">解密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/逆向/">逆向</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/麻花影视/">麻花影视</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/AndroidStudio/" style="font-size: 15.56px;">AndroidStudio</a> <a href="/tags/Binder/" style="font-size: 11.11px;">Binder</a> <a href="/tags/Blog/" style="font-size: 11.11px;">Blog</a> <a href="/tags/Chrome插件/" style="font-size: 10px;">Chrome插件</a> <a href="/tags/Django/" style="font-size: 11.11px;">Django</a> <a href="/tags/Git/" style="font-size: 13.33px;">Git</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/Gson/" style="font-size: 10px;">Gson</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/Hive/" style="font-size: 10px;">Hive</a> <a href="/tags/IPC/" style="font-size: 11.11px;">IPC</a> <a href="/tags/Java/" style="font-size: 18.89px;">Java</a> <a href="/tags/Jekyll/" style="font-size: 10px;">Jekyll</a> <a href="/tags/Linux/" style="font-size: 12.22px;">Linux</a> <a href="/tags/MPAndroidChart/" style="font-size: 10px;">MPAndroidChart</a> <a href="/tags/Mac/" style="font-size: 13.33px;">Mac</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/Nodejs/" style="font-size: 12.22px;">Nodejs</a> <a href="/tags/Notification/" style="font-size: 10px;">Notification</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/PS笔记/" style="font-size: 12.22px;">PS笔记</a> <a href="/tags/PhotoShop/" style="font-size: 12.22px;">PhotoShop</a> <a href="/tags/PostGreSQL/" style="font-size: 13.33px;">PostGreSQL</a> <a href="/tags/Proguard/" style="font-size: 10px;">Proguard</a> <a href="/tags/Python/" style="font-size: 16.67px;">Python</a> <a href="/tags/SQL/" style="font-size: 11.11px;">SQL</a> <a href="/tags/Smali/" style="font-size: 10px;">Smali</a> <a href="/tags/Sublime/" style="font-size: 11.11px;">Sublime</a> <a href="/tags/ValueAnimator/" style="font-size: 10px;">ValueAnimator</a> <a href="/tags/ViewPager/" style="font-size: 10px;">ViewPager</a> <a href="/tags/WorPress/" style="font-size: 10px;">WorPress</a> <a href="/tags/Zip/" style="font-size: 10px;">Zip</a> <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/jni/" style="font-size: 10px;">jni</a> <a href="/tags/ndk/" style="font-size: 10px;">ndk</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/postgres/" style="font-size: 10px;">postgres</a> <a href="/tags/个人想法/" style="font-size: 10px;">个人想法</a> <a href="/tags/其他/" style="font-size: 11.11px;">其他</a> <a href="/tags/加密/" style="font-size: 13.33px;">加密</a> <a href="/tags/动画/" style="font-size: 10px;">动画</a> <a href="/tags/协议/" style="font-size: 10px;">协议</a> <a href="/tags/压缩/" style="font-size: 10px;">压缩</a> <a href="/tags/周易/" style="font-size: 10px;">周易</a> <a href="/tags/命令行/" style="font-size: 11.11px;">命令行</a> <a href="/tags/大数据/" style="font-size: 10px;">大数据</a> <a href="/tags/工具/" style="font-size: 12.22px;">工具</a> <a href="/tags/快捷键/" style="font-size: 10px;">快捷键</a> <a href="/tags/打包/" style="font-size: 10px;">打包</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件存储/" style="font-size: 10px;">文件存储</a> <a href="/tags/泛型/" style="font-size: 10px;">泛型</a> <a href="/tags/源码/" style="font-size: 10px;">源码</a> <a href="/tags/站内搜索/" style="font-size: 10px;">站内搜索</a> <a href="/tags/算法/" style="font-size: 14.44px;">算法</a> <a href="/tags/编码/" style="font-size: 10px;">编码</a> <a href="/tags/编译/" style="font-size: 12.22px;">编译</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a> <a href="/tags/解密/" style="font-size: 10px;">解密</a> <a href="/tags/逆向/" style="font-size: 17.78px;">逆向</a> <a href="/tags/面试/" style="font-size: 13.33px;">面试</a> <a href="/tags/麻花影视/" style="font-size: 16.67px;">麻花影视</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/12/27/2018-12-27-麻花影视会员蓝关分析（方案不可行）/">2018-12-27-麻花影视会员蓝关分析（方案不可行）</a>
          </li>
        
          <li>
            <a href="/2018/12/25/2018-12-25-麻花影视去除热门视频强制分享的要求（完成）/">2018-12-25-麻花影视去除热门视频强制分享的要求（完成）</a>
          </li>
        
          <li>
            <a href="/2018/12/18/2018-12-18-麻花影视模拟发送请求（完成）/">2018-12-18-麻花影视模拟发送请求（完成）</a>
          </li>
        
          <li>
            <a href="/2018/12/17/2018-12-17-解密麻花影视视频播放地址（完成）/">2018-12-17-解密麻花影视视频播放地址（完成）</a>
          </li>
        
          <li>
            <a href="/2018/12/16/2018-12-16-绕过麻花影视抓包检测（完成）/">2018-12-16-绕过麻花影视抓包检测（完成）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 QX<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>
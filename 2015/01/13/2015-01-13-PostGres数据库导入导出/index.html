<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>PostGres数据库导入导出 · 我的程序世界</title><meta name="description" content="PostGres数据库导入导出 - Qiang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><!-- fonts--><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="http://fonts.lug.ustc.edu.cn/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><input type="checkbox" id="sidebar-toggle"><aside><div class="author"><a href="/."><img src="/img/author.png" class="author-img"></a><h2 class="author-name">Qiang</h2></div><div class="post-toc"><span class="toc-title">Directory</span><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据导出，备份"><span class="toc-text">数据导出，备份</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据导入，数据恢复"><span class="toc-text">数据导入，数据恢复</span></a></li></ol></div></aside><div class="main"><header><div id="top"><a href="/." class="logo-link">我的程序世界</a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">关于</a></li><li class="nav-list-item"><a href="/search.html" target="_self" class="nav-list-link">搜索</a></li></ul></div></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">PostGres数据库导入导出</h1><div class="post-time">Jan 13, 2015</div><div class="post-content"><h2 id="数据导出，备份"><a href="#数据导出，备份" class="headerlink" title="数据导出，备份"></a>数据导出，备份</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[node@gpmather ~]$ pg_dump -f clickworld.sql -i  -C -E UTF8 -n public  -U admin -h 192.168.1.87 -W clinkworld</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">假设我在192.168.1.87 上有一个名为 clinkworld的数据库，想把它备份到装有pg_dump服务的任何主机上，我在这个装有pg_dump服务的主机或者客户端，运行以上代码</div><div class="line"></div><div class="line">[code lang=&quot;sql&quot;]</div><div class="line"></div><div class="line">一般选项:</div><div class="line"></div><div class="line">  -f, --file=FILENAME          输出文件或目录名</div><div class="line"></div><div class="line">  -F, --format=c|d|t|p         输出文件格式 (定制, 目录, tar)</div><div class="line"></div><div class="line">                               明文 (默认值))</div><div class="line"></div><div class="line">  -v, --verbose                详细模式</div><div class="line"></div><div class="line">  -V, --version                输出版本信息，然后退出</div><div class="line"></div><div class="line">  -Z, --compress=0-9           被压缩格式的压缩级别</div><div class="line"></div><div class="line">  --lock-wait-timeout=TIMEOUT  在等待表锁超时后操作失败</div><div class="line"></div><div class="line">  -?, --help                   显示此帮助, 然后退出</div><div class="line"></div><div class="line">控制输出内容选项:</div><div class="line"></div><div class="line">  -a, --data-only              只转储数据,不包括模式</div><div class="line"></div><div class="line">  -b, --blobs                  在转储中包括大对象</div><div class="line"></div><div class="line">  -c, --clean                  在重新创建之前，先清除（删除）数据库对象</div><div class="line"></div><div class="line">  -C, --create                 在转储中包括命令,以便创建数据库</div><div class="line"></div><div class="line">  -E, --encoding=ENCODING      转储以ENCODING形式编码的数据</div><div class="line"></div><div class="line">  -n, --schema=SCHEMA          只转储指定名称的模式</div><div class="line"></div><div class="line">  -N, --exclude-schema=SCHEMA  不转储已命名的模式</div><div class="line"></div><div class="line">  -o, --oids                   在转储中包括 OID</div><div class="line"></div><div class="line">  -O, --no-owner               在明文格式中, 忽略恢复对象所属者</div><div class="line"></div><div class="line">  -s, --schema-only            只转储模式, 不包括数据    只导出数据库结构</div><div class="line"></div><div class="line">  -S, --superuser=NAME         在明文格式中使用指定的超级用户名</div><div class="line"></div><div class="line">  -t, --table=TABLE            只转储指定名称的表</div><div class="line"></div><div class="line">  -T, --exclude-table=TABLE    不转储指定名称的表</div><div class="line"></div><div class="line">  -x, --no-privileges          不要转储权限 (grant/revoke)</div><div class="line"></div><div class="line">  --binary-upgrade             只能由升级工具使用</div><div class="line"></div><div class="line">  --column-inserts             以带有列名的INSERT命令形式转储数据</div><div class="line"></div><div class="line">  --disable-dollar-quoting     取消美元 (符号) 引号, 使用 SQL 标准引号</div><div class="line"></div><div class="line">  --disable-triggers           在只恢复数据的过程中禁用触发器</div><div class="line"></div><div class="line">  --exclude-table-data=TABLE   不转储指定名称的表中的数据</div><div class="line"></div><div class="line">  --inserts                    以INSERT命令，而不是COPY命令的形式转储数据</div><div class="line"></div><div class="line">  --no-security-labels         不转储安全标签的分配</div><div class="line"></div><div class="line">  --no-tablespaces             不转储表空间分配信息</div><div class="line"></div><div class="line">  --no-unlogged-table-data     不转储没有日志的表数据</div><div class="line"></div><div class="line">  --quote-all-identifiers      所有标识符加引号，即使不是关键字</div><div class="line"></div><div class="line">  --section=SECTION            备份命名的节 (数据前, 数据, 及 数据后)</div><div class="line"></div><div class="line">  --serializable-deferrable   等到备份可以无异常运行</div><div class="line"></div><div class="line">  --use-set-session-authorization</div><div class="line"></div><div class="line">                               使用 SESSION AUTHORIZATION 命令代替</div><div class="line"></div><div class="line">                ALTER OWNER 命令来设置所有权</div><div class="line"></div><div class="line">联接选项:</div><div class="line"></div><div class="line">  -h, --host=主机名        数据库服务器的主机名或套接字目录</div><div class="line"></div><div class="line">  -p, --port=端口号        数据库服务器的端口号</div><div class="line"></div><div class="line">  -U, --username=名字      以指定的数据库用户联接</div><div class="line"></div><div class="line">  -w, --no-password        永远不提示输入口令</div><div class="line"></div><div class="line">  -W, --password           强制口令提示 (自动)</div><div class="line"></div><div class="line">  --role=ROLENAME          在转储前运行SET ROLE</div></pre></td></tr></table></figure>
<h2 id="数据导入，数据恢复"><a href="#数据导入，数据恢复" class="headerlink" title="数据导入，数据恢复"></a>数据导入，数据恢复</h2><p><code>[node@gpmather ~]$  psql -f clickworld.sql -h 192.168.1.108 -U admin -W clinkworld</code></p>
<p>我把本地的 clickworld.sql 这个文件中的数据恢复到192.168.1.108 这台主机，并且创建表，但是在192.168.1.108 上 clinkworld 是先要创建好的。</p>
<p>附：</p>
<p>   最后一个参数，是数据库名称了</p>
<ol>
<li><p>只导出所有对象的数据库结构</p>
<p>C:>pg_dump -f backup.sql -i  -C -E UTF8 -n public -s  -U admin -h localhost -W clinkworld</p>
</li>
<li><p>导出所有对象的数据库结构和数据</p>
<p>C:>pg_dump -f backup.sql -i  -C -E UTF8 -n public  -U admin -h localhost -W clinkworld</p>
<p>没有-s参数</p>
</li>
<li><p>只导出所有的表数据</p>
<p>C:>pg_dump -f backup.sql -i -a -C -E UTF8 -n public  -U admin -h localhost -W clinkworld</p>
<p>-a 只导出数据</p>
</li>
</ol>
</div></article></div><div class="tags"><a href="/tags/PostGreSQL/">PostGreSQL</a></div><div class="paginator"><a href="/2015/01/24/2015-02-25-字符编码简介/" class="prev"><i class="fa fa-chevron-left"></i><span> 上一页</span></a><a href="/2015/01/04/2015-01-04-Postgres序列操作/" class="next"><span>下一页</span><i class="fa fa-chevron-right"></i></a></div></section><footer><section id="comments"><div data-thread-key="http://febsky.me/2015/01/13/2015-01-13-PostGres数据库导入导出/index.html" data-title="PostGres数据库导入导出" data-url="http://febsky.me/2015/01/13/2015-01-13-PostGres数据库导入导出/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "febsky" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section><div class="copyright"><p>© 2016<span class="heart"><i class="icon-next-heart fa fa-heart"></i></span><a href="http://febsky.me">Qiang</a></p></div></footer></div><label for="sidebar-toggle" class="sidebar-menu"><i class="fa fa-bars"></i></label><label class="back2top"> <a href="#top"><i class="fa fa-chevron-up"></i></a></label></body></html>